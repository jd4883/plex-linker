---
description: Plex Linker Python and container standards
globs: "**/*.py"
alwaysApply: true
---

# Plex Linker project rules

- **Flat layout**: All Python modules are flat files in deploy/docker/ — no sub-packages. Files: main.py, app.py, config.py, db.py, api_clients.py, linker.py, yaml_config.py.
- **Entrypoint**: One Python entrypoint (`main.py`). No shell wrappers; run as `python3 main.py serve` or `python3 main.py`.
- **Config**: `config.py` defines a frozen `Settings` dataclass; use `get_settings()` to access. All env vars default in the Dockerfile and in the dataclass.
- **Containers**: Chainguard Python base image. Run as non-root (UID 65532); no `USER root` in production.
- **No dead code**: No forwarding stubs, no empty __init__.py packages, no no-op functions. Every module has a clear purpose.
- **Logging**: Use `logging.getLogger(__name__)` — no custom messaging layers.
- **Symlinks**: Use `os.symlink` with `os.path.relpath` for relative links — never shell out to `ln`.
- **No os.chdir**: Always use absolute/explicit paths.
- **Python**: Type hints on all public functions. Docstrings for public APIs. Prefer standard library and a minimal dependency set.
